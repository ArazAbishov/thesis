% TODO: you should be using terms flat and tree representation (to match with the documentation)
% TODO: figure out how to make all tables consistently wide across the thesis
% TODO: consistent references (the format of author names, years, pages, etc)
% TODO: make sure that pre-face is padded correctly for printing

\documentclass[12pt,a4paper,english,twoside,openright]{report}
\usepackage{parskip}

\usepackage[includeheadfoot, inner=3.5cm, outer=3.5cm]{geometry}
\setlength{\headheight}{15pt}

\usepackage{emptypage}
\usepackage{pdfpages}

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[LE,RO]{\thepage}
\renewcommand{\sectionmark}[1]{ \markright{\thesection\ #1}{} }
\fancyhead[RE,LO]{\rightmark}

\usepackage{ragged2e}
\usepackage{adjustbox}
\usepackage{float}
% \floatstyle{boxed}
% \restylefloat{figure}


\usepackage{fontspec}
\defaultfontfeatures{
  Extension = .otf,
  Path = fonts/,
  UprightFont = *-Regular,
  BoldFont = *-Bold,
  ItalicFont = *-Italic,
  BoldItalicFont = *-BoldItalic,
}
\setmainfont[Scale = 0.9]{Charter}
\newfontfamily\headingfont{Charter}
% \setmainfont[Scale = 0.8]{Merriweather}
% \newfontfamily\headingfont{Sansita}
\setmonofont[Scale = 0.85]{SourceCodePro}

\usepackage{titlesec}
\titleformat{\chapter}[display]
  {\headingfont\bfseries}{\LARGE\chaptertitlename\ \thechapter}{5pt}{\Huge}
\titleformat*{\section}{\LARGE\headingfont\bfseries\itshape}
\titleformat*{\subsection}{\Large\headingfont\itshape}
\titleformat*{\subsubsection}{\large\headingfont}

\usepackage[
  colorinlistoftodos,
  prependcaption,
  textsize=small
]{todonotes}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc,url}
\urlstyle{sf}

\usepackage[binary-units=true]{siunitx}
\DeclareSIUnit{\nothing}{\relax}
\newcommand{\kilo}[1]{\SI{#1}{\kilo\nothing}}
\newcommand{\mega}[1]{\SI{#1}{\mega\nothing}}
\newcommand{\micros}[1]{\SI{#1}{\micro\second}}
\newcommand{\millis}[1]{\SI{#1}{\milli\second}}
\newcommand{\seconds}[1]{\SI{#1}{\second}}
\newcommand{\mbytes}[1]{\SI{#1}{\mega\byte}}
\newcommand{\gbytes}[1]{\SI{#1}{\giga\byte}}

\usepackage{algpseudocode}
\usepackage{amssymb}
\usepackage{tikz}
\usetikzlibrary{matrix,arrows,backgrounds,fit}

\usepackage{pgfplots}
\usepgfplotslibrary{units}
\usepgfplotslibrary{groupplots}
\pgfplotsset{compat=1.16}

\usepackage{minted}
\newmintinline[ir]{rust}{}
\newmintedfile[rustfile]{rust}{}

\usepackage{babel,textcomp,csquotes,varioref,graphicx}

\usepackage[
  backend=biber,
  maxbibnames=6,
  isbn=false,
  doi=false,
  defernumbers=true
]{biblatex}
\addbibresource{refs.bib}
\setlength\bibitemsep{\baselineskip}

\usepackage[
  pdftitle={Efficient Persistent Vector Implementation for Rust},
  pdfauthor={Araz Abishov},
  hidelinks=true,
  unicode=true  
]{hyperref}
\urlstyle{same}
\usepackage{cleveref}

\raggedbottom

\newcommand{\type}[1]{\emph{\textbf{#1}}}
\newcommand{\crate}[1]{\emph{\textbf{#1}}}

\newcommand{\bigo}[1]{$\mathcal{O}(#1)$}
\newcommand{\bigochar}[1]{$\mathcal{O}$}
\newcommand{\range}[1]{#1}

\newcommand{\pvecrs}{\crate{pvec-rs}}
\newcommand{\imrs}{\crate{imrs}}
\newcommand{\rpds}{\crate{rpds}}
\newcommand{\rayon}{\crate{rayon}}

% Used to refer to the RRB-Tree type 
% provided by pvec-rs.
\newcommand{\rrbtree}{\type{rrbtree}}

% This macro is used to refer to the RRB-Tree 
% as a concept, rather than a concrete type 
% provided by pvec-rs. 
\newcommand{\treerrb}{\emph{RRB-Tree}}

\newcommand{\refcell}{\type{refcell}}
\newcommand{\arc}{\type{arc}}
\newcommand{\rc}{\type{rc}}

\newcommand{\rbtree}{\type{rbtree}}
\newcommand{\rbvec}{\type{rbvec}}
\newcommand{\rrbvec}{\type{rrbvec}}
\newcommand{\pvec}{\type{pvec}}
\newcommand{\imrsvec}{\type{imvec}}
\newcommand{\stdvec}{\type{vec}}

\newcommand{\m}{$m$}
\newcommand{\h}{$h$}
\newcommand{\x}{$x$}
\newcommand{\nil}{\emph{NIL}}
\newcommand{\la}{$\leftarrow$}
\newcommand{\ts}[1]{\textsubscript{#1}}
\newcommand{\n}{\emph{N}}

\algnewcommand\And{\textbf{and}}
\algnewcommand\In{\textbf{in}}

\colorlet{color-path}{blue!30}
\colorlet{color-node}{blue!10}

\definecolor{morange}{HTML}{FF9800}
\definecolor{mpurple}{HTML}{512DA8}
\definecolor{mred}{HTML}{D32F2F}
\definecolor{mgreen}{HTML}{689F38}

\title{Efficient Persistent Vector Implementation for Rust}
\author{Araz Abishov}

\begin{document}

\pagenumbering{roman}
\includepdf[pages={-}]{forside/forside.pdf}
\setcounter{page}{5}

\pdfbookmark[0]{Front matter}{bm-frontmatter}
\pdfbookmark[1]{Contents}{bm-toc}
\tableofcontents{}

\cleardoublepage
\pdfbookmark[1]{List of Listings}{bm-listings}
\listoflistings

\cleardoublepage
\pdfbookmark[1]{List of Figures}{bm-figures}
\listoffigures

\cleardoublepage
\include{chapters/abstract}

\cleardoublepage
\include{chapters/acknowledgements}

\cleardoublepage
\include{chapters/preface}

\pagenumbering{arabic}

\include{chapters/introduction}
\include{chapters/rbtree}
\include{chapters/rrbtree}
\include{chapters/pvec}
\include{chapters/methodology}
\include{chapters/benchmarks}
\include{chapters/conclusion}

\listoftodos

\printbibliography
\end{document}
